---
// src/pages/projects.astro
import { getCollection } from 'astro:content';
import PageLayout from '@/layouts/CommonPage.astro';
import ProjectCard from '@/components/projects/ProjectCard.astro';
// import ProjectInfo from '@/components/projects/ProjectInfo.astro'; // Keep for later modal integration

// Fetch all project entries from the content collection
const allProjects = await getCollection('projects', () => {
  // Optional: Filter out drafts or future-dated projects if you add such fields
  return true; // return data.draft !== true;
});

allProjects.sort((a, b) => {
    const orderA = a.data.order ?? Infinity;
    const orderB = b.data.order ?? Infinity;
    if (orderA !== orderB) return orderA - orderB;
    return a.data.projectName.localeCompare(b.data.projectName);
});

const DIALOG_ID = 'project-info-dialog'; // Will be used for the modal
---

<PageLayout title='Projects' info={{ slug: '/projects', hideComment: true }} useSidebar={false}>
  <p class="mb-8 text-lg text-muted-foreground">
    Here are some of the projects I've worked on. Click on a card to see more details or run them live.
  </p>

  <div class="grid grid-cols-1 gap-2 sm:grid-cols-2 lg:grid-cols-3">
    {/* Render each project card */}
    {allProjects.map(project => (
      <ProjectCard project={project} dialogId={DIALOG_ID} />
    ))}
  </div>
</PageLayout>
